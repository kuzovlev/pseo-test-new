import { withAssetBase } from "@/lib/pseo-assets";
import type { PseoPageData } from "@/lib/pseo-types";

const HTML = "<section class=\"section_cta\" data-wf--cta-section--variant=\"base\" id=\"cta-block\">\n<div class=\"spacer-144 tablet_spacer-80\"></div>\n<div class=\"padding-global\">\n<div class=\"container-1344 z-index-1\">\n<div class=\"cta-heading_wrapper\">\n<div class=\"max-width-828 align-center\">\n<h2 class=\"text-align-center\">One subscription and your hiring problems <span class=\"cta_faces\"> </span>\u00a0solved</h2>\n</div>\n</div>\n<div class=\"spacer-40\"></div>\n<div>\n<div class=\"cta_form-block w-form\">\n<form action=\"https://#\" class=\"cta_form\" data-name=\"cta-email\" data-wf-element-id=\"5bfefd48-2af9-fa9f-530a-3764d21b762b\" data-wf-page-id=\"697b4beefe76cf9edba9761c\" id=\"wf-form-cta-email\" method=\"get\" name=\"wf-form-cta-email\"><input class=\"input cta_input w-input\" data-name=\"cta-email\" id=\"cta-email\" maxlength=\"256\" name=\"cta-email\" placeholder=\"Email address\" required=\"\" type=\"email\"/>\n<div class=\"submit-button_wrapper\"><input class=\"submit-button w-button\" data-wait=\"Please wait...\" type=\"submit\" value=\"Submit\"/>\n<a button-black=\"\" calendly-link=\"\" class=\"button is-large w-inline-block\" data-wf--button-black-l--variant=\"base\" href=\"#\">\n<div class=\"z-index-1\">Get matched</div>\n<div class=\"button-background\"></div><img alt=\"\" class=\"button-icon\" height=\"20\" loading=\"lazy\" src=\"__ASSET_BASE__/images/login-icon-white.svg\"/>\n</a>\n</div>\n</form>\n<div class=\"w-form-done\">\n<div>Thank you! Your submission has been received!</div>\n</div>\n<div class=\"w-form-fail\">\n<div>Oops! Something went wrong while submitting the form.</div>\n</div>\n</div>\n</div>\n</div>\n</div><img alt=\"\" class=\"moving-circle\" id=\"cta-circle\" loading=\"lazy\" src=\"__ASSET_BASE__/images/moving-ellipse.svg\"/>\n<div class=\"w-embed\">\n<style>\n  .section_cta.animate-background .cta-bg-image{\n    bottom: -20%;\n  }\n  @media screen and (max-width: 991px){\n    .section_cta .cta-bg-image{\n      width: 1100px;\n      max-width: none;\n    }\n    .section_cta.animate-background .cta-bg-image{\n      bottom: 0%;\n      /*left: -30%;*/\n    }\n  }\n  @media screen and (max-width: 467px){\n    .section_cta .cta-bg-image{\n      width: 670px;\n      max-width: none;\n    }\n  }\n</style>\n</div><img alt=\"decorative image in cta block\" class=\"cta-bg-image\" data-src=\"https://awesomic-prod.nyc3.cdn.digitaloceanspaces.com/site/Home page images/CTA img.jpg\" id=\"cta-dec-image\" loading=\"lazy\"/>\n<div class=\"hide w-embed w-script\">\n<script>\n  /*document.addEventListener(\"DOMContentLoaded\", (event) => {\n    document.querySelector('.cta-bg-image').src = document.querySelector('.cta-bg-image').getAttribute('data-src');\n  });*/\n  if(window.innerWidth > 991){\n    const circle = document.getElementById('cta-circle');\n    const ctaBlock = document.getElementById('cta-block');\n    ctaBlock.addEventListener('mousemove', function(event) {\n      const rect = ctaBlock.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      circle.style.left = (x - 370) + 'px';\n      circle.style.top  = (y - 320) + 'px';\n      circle.style.opacity = 1;\n    });\n    ctaBlock.addEventListener('mouseleave', function() {\n      circle.style.opacity = 0;\n    });\n    circle.style.opacity = 0;\n  }\n  const ctaSection = document.querySelector('.section_cta');\n  const imgObserver = new IntersectionObserver(\n    (entries) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) {\n          ctaSection.classList.add('animate-background');\n        } else {\n          ctaSection.classList.remove('animate-background');\n        }\n      });\n    },\n    { threshold: 0.5 }\n  );\n  if (ctaSection) {\n    imgObserver.observe(ctaSection);\n  }\n  const imageToLoad = document.getElementById('cta-dec-image');\n  if (imageToLoad) {\n    const imageSection = imageToLoad.closest('section');\n    const prevSection = imageSection?.previousElementSibling;\n    const nextSection = imageSection?.nextElementSibling;\n    const loadImage = () => {\n      if (imageToLoad.dataset.src) {\n        imageToLoad.src = imageToLoad.dataset.src;\n        imageToLoad.removeAttribute('data-src');\n        ctaImageObserver.disconnect();\n        initialObserver.disconnect();\n      }\n    };\n    // Observe when image section is already in view (page load case)\n    const initialObserver = new IntersectionObserver((entries) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) loadImage();\n      });\n    }, { threshold: 0.1 });\n    if (imageSection) initialObserver.observe(imageSection);\n    // Observe prev and next sections\n    const ctaImageObserver = new IntersectionObserver((entries) => {\n      entries.forEach(entry => {\n        if (entry.isIntersecting) loadImage();\n      });\n    }, { threshold: 0.1 });\n    if (prevSection?.tagName === 'SECTION') ctaImageObserver.observe(prevSection);\n    if (nextSection?.tagName === 'SECTION') ctaImageObserver.observe(nextSection);\n  }\n</script>\n</div>\n</section>";

/**
 * Airtable mapping notes:
 * - Keep text static for now.
 * - When ready, replace specific static nodes with {data?.fieldName ?? "Default"}.
 * - Suggested fields live in lib/pseo-types.ts
 */
export function CtaSection(_props: { data?: PseoPageData }) {
  return <div dangerouslySetInnerHTML={ { __html: withAssetBase(HTML) } } />;
}
